# description: command line configuration

[calamr_default]
results_dir = ~/Desktop/amr-graph

[cli]
apps = list: ${cli_config_default:apps}, show_config_cli, clear_cli,
  sapp, aapp, capp, papp
cleanups = list: ${cli_config_default:cleanups}, show_config_cli,
  capp_decorator, aapp_decorator, sapp_decorator, papp
cleanup_removes = list: log_cli

[log_default]
# to enable stash prime messages, set the warn levels to info
prime_level = warn

[log_cli]
format = %%(levelname)s:T%%(asctime)s:P:%%(process)d:%%(name)s:%%(message)s
loggers = dict: {
  'transformers': 'err',
  'zensols.cli.lib': 'info',
  'zensols.install': 'info',
  'zensols.amr.app': 'info',
  'zensols.amr.align': 'info',
  'zensols.amr.annotate': '${log_default:prime_level}',
  'zensols.amr.stash': 'info',
  'zensols.datdesc': 'info',
  'zensols.calamr': '${log_default:prime_level}',
  'zensols.calamr.app': 'info',
  'zensols.calamr.score': 'info',
  'zensols.calamr.aligner': '${log_default:prime_level}',
  'zensols.calamr.stash': '${log_default:prime_level}',
  'zensols.calamr.adhoc': '${log_default:prime_level}'}

[multiprocess_log_config]
section = log_cli

[clear_cli]
class_name = zensols.cli.CacheClearer
clearables = tuple: amr_default:clearables, calamr_default:clearables

[import]
config_files = list:
  resource(zensols.util): resources/default.conf,
  resource(zensols.util): resources/cli.conf,
  resource(zensols.util): resources/cli-config.conf

[config_cli]
# missing configuration files allowed
expect = False
#cache_path = path: ${default:data_dir}/app-config.dat

[config_import]
sections = list: app_conf_imp
references = list: default, package

[opt_defaults]
output_dir = {
  'long_name': 'outdir', 'short_name': 'o',
  'metavar': 'DIR', 'default': '${calamr_default:results_dir}',
  'doc': 'the output directory or ``-`` for standard out'}
input_file = {
  'long_name': 'input', 'short_name': 'i',
  'metavar': '<FILE|DIR>'}

[app_conf_imp]
type = import
config_files = list: 
  ^{config_path}, ^{override},
  resource(zensols.deeplearn): resources/default.conf,
  resource(zensols.deepnlp): resources/default.conf,
  resource(zensols.amr): resources/default.conf,
  resource(zensols.propbankdb): resources/default.conf,
  resource(zensols.rend): resources/default.conf,
  resource(zensols.calamr): resources/default.conf,
  ^{config_path}, ^{override},
  resource(zensols.calamr): resources/corpus.conf,
  ^{config_path}, ^{override},
  resource(zensols.nlp): resources/obj.conf,
  resource(zensols.nlp): resources/component.conf,
  resource(zensols.nlp): resources/mapper.conf,
  resource(zensols.nlp): resources/score.yml,
  resource(zensols.deeplearn): resources/obj.conf,
  resource(zensols.deepnlp): resources/obj.conf,
  resource(zensols.amr): resources/obj.conf,
  resource(zensols.amr): resources/annotate.conf,
  resource(zensols.amr): resources/align.yml,
  resource(zensols.amr): resources/coref.conf,
  resource(zensols.amr): resources/serial.conf,
  resource(zensols.amr): resources/score.yml,
  resource(zensols.propbankdb): resources/obj.yml,
  resource(zensols.propbankdb): resources/embed.yml,
  resource(zensols.rend): resources/obj.conf,
  resource(zensols.calamr): resources/obj.conf,
  resource(zensols.calamr): resources/score.yml,
  resource(zensols.calamr): resources/corpus.conf,
  resource(zensols.calamr): resources/adhoc.yml,
  ^{config_path}, ^{override}

[capp]
class_name = zensols.calamr.CorpusApplication
resources = instance: calamr_resources
results_dir = path: ${calamr_default:results_dir}

[capp_decorator]
option_excludes = set: config_factory, results_dir
option_overrides = dict: {
  'output_file': {'long_name': 'output', 'short_name': 'o'},
  'output_dir': ${opt_defaults:output_dir},
  'report_file': {'long_name': 'agg', 'short_name': None,
                   'default': '${calamr_default:results_dir}'},
  'output_format': {'long_name': 'format', 'short_name': 'f'},
  'render_level': {'long_name': 'rendlevel', 'short_name': 'r'},
  'use_cached': {'long_name': 'cached', 'short_name': None},
  'keys': {'metavar': '<STRING|ALL>'}}
mnemonic_overrides = dict: {
  'download_corpus': 'download',
  'write_adhoc_corpus': 'mkadhoc',
  'write_keys': 'keys',
  'dump_annotated': 'dump',
  'create_mismatch_proxy_corpus': 'miscorp',
  'clear_doc_cache': 'cleardoc'}
mnemonic_excludes = set: get_annotated_summary

[aapp]
class_name = zensols.calamr.AlignmentApplication
resources = instance: calamr_resources

[aapp_decorator]
option_excludes = set: config_factory
option_overrides = dict: {
  'output_dir': ${opt_defaults:output_dir},
  'input_file': ${opt_defaults:input_file},
  'output_format': {'long_name': 'format', 'short_name': 'f'},
  'render_level': {'long_name': 'rendlevel', 'short_name': 'r'}}

[sapp]
class_name = zensols.amr.ScorerApplication
log_config = instance: log_cli
doc_factory = instance: amr_feature_doc_factory

[sapp_decorator]
option_excludes = set: config_factory, anon_doc_stash
option_overrides = dict: {
  'input_file': ${opt_defaults:input_file},
  'output_dir': ${opt_defaults:output_dir},
  'input_gold': {'long_name': 'gold'},
  'input_parsed': {'long_name': 'parsed', 'short_name': None},
  'output_format': {'long_name': 'format', 'short_name': 'f'},
  'meta_keys': {'long_name': 'metakeys', 'short_name': None}}
mnemonic_overrides = dict: {'parse_penman': 'penman'}
mnemonic_excludes = set: remove_wiki

[papp]
class_name = zensols.calamr.proto._ProtoApplication
resources = instance: calamr_resources
